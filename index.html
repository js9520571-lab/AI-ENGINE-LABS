<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Q-Studio | Professional Design Suite</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #0f172a; color: white; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        .sidebar { width: 260px; background: #1e293b; border-right: 1px solid #334155; }
        .canvas-container { box-shadow: 0 20px 50px rgba(0,0,0,0.5); border-radius: 8px; overflow: hidden; }
        .tool-btn { @apply w-full flex items-center gap-3 p-3 rounded-xl hover:bg-blue-600 transition text-sm font-medium mb-2; }
        /* Style the actual canvas drawing area */
        .canvas-wrapper { background-image: radial-gradient(#334155 1px, transparent 1px); background-size: 20px 20px; }
    </style>
</head>
<body>

    <nav class="h-16 bg-slate-900 border-b border-slate-800 flex items-center px-6 justify-between z-20">
        <div class="flex items-center gap-8">
            <h1 class="text-xl font-black text-blue-500 tracking-tighter">Q-STUDIO</h1>
            <div id="controls" class="hidden flex items-center gap-4 bg-slate-800 px-4 py-1.5 rounded-full border border-slate-700">
                <input type="color" id="colorObj" oninput="updateColor(this.value)" class="w-6 h-6 bg-transparent cursor-pointer">
                <div class="h-4 w-[1px] bg-slate-700"></div>
                <button onclick="changeLayer('front')" class="text-[10px] font-bold uppercase hover:text-blue-400">Bring Front</button>
                <button onclick="changeLayer('back')" class="text-[10px] font-bold uppercase hover:text-blue-400">Send Back</button>
            </div>
        </div>
        <button onclick="downloadDesign()" class="bg-blue-600 px-6 py-2 rounded-full text-xs font-bold hover:bg-blue-500 transition shadow-lg shadow-blue-500/20">Export Design</button>
    </nav>

    <div class="flex flex-1 overflow-hidden">
        <aside class="sidebar p-6 flex flex-col">
            <p class="text-[10px] font-bold text-slate-500 uppercase mb-4 tracking-widest">Elements</p>
            <button onclick="addRect()" class="tool-btn bg-slate-800"><span>‚¨õ</span> Rectangle</button>
            <button onclick="addCircle()" class="tool-btn bg-slate-800"><span>‚ö™</span> Circle</button>
            <button onclick="addText()" class="tool-btn bg-slate-800"><span>T</span> Add Text</button>
            
            <div class="mt-6">
                <p class="text-[10px] font-bold text-slate-500 uppercase mb-4 tracking-widest">Uploads</p>
                <label class="tool-btn bg-blue-600/10 text-blue-400 border border-blue-500/20 cursor-pointer justify-center">
                    <span>+</span> Upload Image
                    <input type="file" class="hidden" onchange="uploadImg(event)">
                </label>
            </div>

            <button onclick="canvas.remove(canvas.getActiveObject())" class="mt-auto tool-btn bg-red-900/20 text-red-400 border border-red-900/30 hover:bg-red-600 hover:text-white">üóëÔ∏è Delete Selected</button>
        </aside>

        <main class="flex-1 canvas-wrapper flex items-center justify-center relative p-12">
            <div class="canvas-container">
                <canvas id="mainCanvas"></canvas>
            </div>
        </main>
    </div>

    <script>
        // Initialize Engine
        const canvas = new fabric.Canvas('mainCanvas', {
            width: 800,
            height: 500,
            backgroundColor: '#ffffff'
        });

        // Show/Hide Top Controls
        canvas.on('selection:created', () => document.getElementById('controls').classList.remove('hidden'));
        canvas.on('selection:cleared', () => document.getElementById('controls').classList.add('hidden'));

        // Core Functions
        function addRect() {
            canvas.add(new fabric.Rect({ width: 150, height: 100, fill: '#3b82f6', left: 100, top: 100, rx: 10, ry: 10 }));
        }

        function addCircle() {
            canvas.add(new fabric.Circle({ radius: 60, fill: '#10b981', left: 150, top: 150 }));
        }

        function addText() {
            canvas.add(new fabric.IText('Type here...', { left: 100, top: 100, fontSize: 30, fontFamily: 'sans-serif', fill: '#1e293b' }));
        }

        function uploadImg(e) {
            const reader = new FileReader();
            reader.onload = f => {
                fabric.Image.fromURL(f.target.result, img => {
                    img.scaleToWidth(300);
                    canvas.add(img);
                });
            };
            reader.readAsDataURL(e.target.files[0]);
        }

        function updateColor(color) {
            const obj = canvas.getActiveObject();
            if(obj) { obj.set('fill', color); canvas.renderAll(); }
        }

        function changeLayer(dir) {
            const obj = canvas.getActiveObject();
            if(!obj) return;
            dir === 'front' ? obj.bringToFront() : obj.sendToBack();
            canvas.renderAll();
        }

        function downloadDesign() {
            const link = document.createElement('a');
            link.download = 'q-studio-export.png';
            link.href = canvas.toDataURL({ format: 'png', quality: 1 });
            link.click();
        }
    </script>
</body>
</html>
